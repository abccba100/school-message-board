<!DOCTYPE html>
<html lang="ko" style="color-scheme: light only; background-color: #ffe9f0; color: #333333;">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="color-scheme" content="light">
    <meta name="supported-color-schemes" content="light">
    <meta name="theme-color" content="#ffe9f0" media="(prefers-color-scheme: light)">
    <meta name="theme-color" content="#ffe9f0" media="(prefers-color-scheme: dark)">
    <title>메시지 전송</title>
    <link rel="stylesheet" href="style.css">
    <style>
        html {
            color-scheme: light only !important;
            background-color: #ffe9f0 !important;
            color: #333333 !important;
            -webkit-color-scheme: light only !important;
        }
        body {
            background:
                radial-gradient(circle at 0% 0%, rgba(255, 255, 255, 0.9) 0, rgba(255, 255, 255, 0) 55%),
                radial-gradient(circle at 100% 100%, rgba(255, 255, 255, 0.95) 0, rgba(255, 255, 255, 0) 55%),
                linear-gradient(135deg, #ffe9f0 0%, #fff4d9 40%, #e3f3ff 80%, #e5ddff 100%) !important;
            background-color: #ffe9f0 !important;
            color: #333333 !important;
        }

        .bg-canvas {
            position: fixed;
            inset: 0;
            width: 100vw;
            height: 100vh;
            z-index: -3;
            pointer-events: none;
        }

        .bg-vignette {
            position: fixed;
            inset: -20px;
            pointer-events: none;
            z-index: -2;
            background:
                radial-gradient(circle at 20% 20%, rgba(255, 255, 255, 0.55) 0, rgba(255, 255, 255, 0) 55%),
                radial-gradient(circle at 80% 80%, rgba(255, 255, 255, 0.45) 0, rgba(255, 255, 255, 0) 60%),
                radial-gradient(circle at 50% -10%, rgba(255, 255, 255, 0.55) 0, rgba(255, 255, 255, 0) 55%);
            mix-blend-mode: screen;
            opacity: 0.9;
        }
    </style>
</head>
<body style="background: linear-gradient(135deg, #ffe9f0 0%, #fff4d9 40%, #e3f3ff 80%, #e5ddff 100%); background-color: #ffe9f0; color: #333333;">
    <canvas id="bgCanvas" class="bg-canvas" aria-hidden="true"></canvas>
    <div class="bg-vignette" aria-hidden="true"></div>
    <div class="bg-orbs" aria-hidden="true">
        <span class="orb o1"></span>
        <span class="orb o2"></span>
        <span class="orb o3"></span>
        <span class="orb o4"></span>
    </div>
    <div class="container">
        <div class="page-hero" aria-label="페이지 안내">
            <div class="hero-kicker">DSM 졸업 축하 메시지</div>
            <div class="hero-title">DSM 졸업을 진심으로 축하합니다</div>
            <p class="hero-subtitle">따뜻한 한마디를 남기면, 메시지 공이 되어 함께 떠올라요.</p>
        </div>
        <form id="messageForm">
            <div class="form-group">
                <label for="message">메시지</label>
                <textarea id="message" rows="5" required maxlength="500" placeholder="메시지를 입력하세요"></textarea>
                <div class="char-count"><span id="charCount">0</span>/500</div>
            </div>
            <button type="submit" id="submitBtn">전송</button>
        </form>
        <div id="status"></div>
    </div>
    <script src="/socket.io/socket.io.js"></script>
    <script src="client-send.js"></script>
    <script>
        (() => {
            const canvas = document.getElementById('bgCanvas');
            if (!canvas) return;

            const ctx = canvas.getContext('2d', { alpha: true, desynchronized: true });
            if (!ctx) return;

            const prefersReduced = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;
            const DPR = Math.min(2, window.devicePixelRatio || 1);

            let w = 0, h = 0;
            let rafId = 0;
            let last = performance.now();

            const rnd = (a, b) => a + Math.random() * (b - a);

            const palette = [
                [255, 164, 198], // rose
                [255, 205, 146], // peach
                [170, 222, 255], // sky
                [210, 196, 255], // lavender
                [200, 255, 214], // mint
            ];

            const blobs = Array.from({ length: 14 }, () => {
                const c = palette[(Math.random() * palette.length) | 0];
                const size = rnd(90, 240);
                return {
                    x: rnd(0, 1),
                    y: rnd(0, 1),
                    r: size,
                    a: rnd(0.05, 0.12),
                    vx: rnd(-0.015, 0.015),
                    vy: rnd(-0.015, 0.015),
                    p: rnd(0, Math.PI * 2),
                    ps: rnd(0.08, 0.16),
                    c,
                };
            });

            function resize() {
                w = Math.max(1, window.innerWidth);
                h = Math.max(1, window.innerHeight);
                canvas.width = Math.floor(w * DPR);
                canvas.height = Math.floor(h * DPR);
                canvas.style.width = w + 'px';
                canvas.style.height = h + 'px';
                ctx.setTransform(DPR, 0, 0, DPR, 0, 0);
            }

            function draw(now) {
                const dt = Math.min(0.05, Math.max(0.001, (now - last) / 1000));
                last = now;

                ctx.clearRect(0, 0, w, h);
                ctx.globalCompositeOperation = 'source-over';
                ctx.fillStyle = 'rgba(255,255,255,0)';
                ctx.fillRect(0, 0, w, h);

                ctx.globalCompositeOperation = 'lighter';

                for (let i = 0; i < blobs.length; i++) {
                    const b = blobs[i];
                    b.p += b.ps * dt;

                    if (!prefersReduced) {
                        b.x += b.vx * dt;
                        b.y += b.vy * dt;
                    }

                    if (b.x < -0.15) b.x = 1.15;
                    if (b.x > 1.15) b.x = -0.15;
                    if (b.y < -0.15) b.y = 1.15;
                    if (b.y > 1.15) b.y = -0.15;

                    const px = b.x * w + Math.sin(b.p) * 18;
                    const py = b.y * h + Math.cos(b.p * 0.9) * 16;
                    const rr = b.r * (0.92 + Math.sin(b.p * 0.7) * 0.08);

                    const g = ctx.createRadialGradient(px - rr * 0.22, py - rr * 0.18, rr * 0.1, px, py, rr);
                    g.addColorStop(0, `rgba(${b.c[0]},${b.c[1]},${b.c[2]},${b.a})`);
                    g.addColorStop(0.65, `rgba(${b.c[0]},${b.c[1]},${b.c[2]},${b.a * 0.55})`);
                    g.addColorStop(1, `rgba(${b.c[0]},${b.c[1]},${b.c[2]},0)`);

                    ctx.fillStyle = g;
                    ctx.beginPath();
                    ctx.arc(px, py, rr, 0, Math.PI * 2);
                    ctx.fill();
                }

                ctx.globalCompositeOperation = 'source-over';
                rafId = requestAnimationFrame(draw);
            }

            resize();
            window.addEventListener('resize', resize, { passive: true });
            rafId = requestAnimationFrame(draw);
        })();
    </script>
</body>
</html>
